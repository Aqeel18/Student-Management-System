<!DOCTYPE html>
<html>
<head>
    <title>{% block title %}Student Management{% endblock %}</title>
    <meta charset="UTF-8">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <script src="{% static 'css/theme.js' %}"></script>
</head>
<body>

<!-- ✅ Navbar -->
<nav class="navbar navbar-expand-lg navbar-dark bg-primary">
    <div class="container-fluid">
        <a class="navbar-brand" href="#">SMS</a>

        <!-- Theme toggle button -->
        <button onclick="toggleTheme()" class="btn btn-secondary ms-2" type="button" style="min-width: 40px;" title="Toggle theme">
            <span class="bi bi-moon"></span> 🌓
        </button>

        <div class="collapse navbar-collapse">
            <ul class="navbar-nav ms-auto">
                {% if user.is_authenticated and not user.is_staff %}
                    {% with user.student as student %}
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle d-flex align-items-center" href="#" id="navbarUser" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                {% if student.profile_photo %}
                                    <img src="{{ student.profile_photo.url }}" alt="Profile" class="rounded-circle me-2" height="30" width="30">
                                {% endif %}
                                <span>
                                  {% with full_name=user.get_full_name %}
                                    {% if full_name %}
                                      {{ full_name }}
                                    {% else %}
                                      {{ user.username }}
                                    {% endif %}
                                  {% endwith %}
                                </span>
                            </a>
                            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarUser">
                                <li>
                                    <form method="GET" action="{% url 'logout' %}">
                                        {% csrf_token %}
                                        <button type="submit" class="dropdown-item">Logout</button>
                                    </form>
                                </li>
                            </ul>   
                        </li>
                    {% endwith %}
                {% else %}
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'login' %}">Login</a>
                    </li>
                {% endif %}
            </ul>
        </div>
    </div>
</nav>

<!-- ✅ Page Content -->
<div class="container-fluid py-4">
    <div class="row">

        {% if user.is_authenticated and not user.is_staff %}
        <!-- ✅ Sidebar for logged-in students only -->
        <div class="col-md-3">
            <div class="list-group">
                <a href="{% url 'home' %}" class="list-group-item list-group-item-action">🏠 Dashboard</a>
                <a href="{% url 'student-profile' %}" class="list-group-item list-group-item-action">📝 Update Profile</a>
                <a href="{% url 'student-results' %}" class="list-group-item list-group-item-action">📊 View Results</a>
                <!-- You can add more links here -->
            </div>
        </div>
        {% endif %}

        <!-- ✅ Main content -->
        <div class="{% if user.is_authenticated %}col-md-9{% else %}col-md-12{% endif %}">
            {% block content %}{% endblock %}
        </div>

    </div>
</div>

</body>
</html>
